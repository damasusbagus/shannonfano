<html>
<head>
	<title>Shannon Fano</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script type="text/javascript">

		 // convert string to binary
		 function text2Binary(string) {
		 	var length = string.length,
		 	output = [];
		 	for (var i = 0;i < length; i++) {
		 		var bin = string[i].charCodeAt().toString(2);
		 		output.push(Array(8-bin.length+1).join("0") + bin);
		 	} 
		 	return output.join("");
		 }
		 // console.log('text2binary='+text2Binary('abc'));

		 //convert binary to whitespace
		 function binarytowhitespace(a){
		 	var data = a.split('');
		 	for (var i = 0; i < a.length; i++) {
		 		if(data[i] == '0'){
		 			data[i] = '*';
		 		}
		 		else{
		 			data[i] = '_';
		 		}
		 	}
		 	var a = data.join('');
		 	return a;
		 }

		 //convert binary to text
		 function binarytotext(binary) {
		 	return binary.replace(/[01]{8}/g, function (v) {
		 		return String.fromCharCode(parseInt(v, 2));
		 	});
		 }

		 //convert whitespace to binary
		 function whitespacetobinary(a){
		 	var data = a.split('');
		 	for (var i = 0; i < a.length; i++) {
		 		if(data[i] == '*'){
		 			data[i] = '0';
		 		}
		 		else{
		 			data[i] = '1';
		 		}
		 	}
		 	var a = data.join('');
		 	return a;
		 }

		 //detect separate character position
		 function detect(data,data2){
		 	var split = data.split('');
		 	var separate = data2.split('');
		 	for (var i = 0; i < split.length; i++) {
		 		if (split[i] == separate[0]){
		 			i++
		 			if (split[i] == separate[1]){
		 				i++
		 				if (split[i] == separate[2]){
		 					i++
		 					if (split[i] == separate[3]){
		 						i++
		 						if (split[i] == separate[4]){
		 							i++
		 							if (split[i] == separate[5]){
		 								i++
		 								if (split[i] == separate[6]){
		 									i++
		 									if (split[i] == separate[7]){
		 										i++
		 										return i;
		 									}
		 								}
		 							}
		 						}
		 					}
		 				}
		 			}
		 		}
		 	}
		 }

		$(document).ready(function(){

			$('button').click(function(){
				var message = $('.message').val(),
					secret = $('.secret').val(),
					symbol = '`';
					result;
				// console.log('secret = '+result);

				 secret = text2Binary (secret,result);
				 // console.log('secret binary = '+secret);

				 console.log('symbol : '+symbol)

				 //convert symbol -> binary -> whitespace
				 symbol = text2Binary(symbol);
				 console.log('binary symbol : '+symbol);
				 symbol = binarytowhitespace(symbol);
				 console.log('whitespace symbol : '+symbol);

				 // convert secret message from binary ro whitespace
				 secret = binarytowhitespace(secret);
				 // console.log('whitespace = '+secret);


				 //combine all data to be result
				 result = message+symbol+secret;
				 console.log('result = '+result);
				 $('#result').val(result);


				 // Decription process
				 var source = $('#result').val(),
				 	 symbol = '`',
			 		 SymbolConvert = binarytowhitespace(text2Binary(symbol)), //convert symbol to whitespace
				 	 SymbolPosition = detect(source,SymbolConvert);
				 	 console.log('detect : '+SymbolPosition);

				 	 // get secret code by delete first 'SymbolPosition' letter
				 	 secret = source.substr(SymbolPosition);
				 	 console.log('source delete : '+secret);

				 	 // get first 'SymbolPosition' letter
				 	 message = source.slice(0, SymbolPosition-8);
					 console.log('message : '+message);

					 // convert whitespace to text
				 	 secret = binarytotext(whitespacetobinary(secret));
				 	 console.log(secret);

				 	 $('#decript').val(message+secret);
		});

		});
	</script>
</head>

<body>
	<div style="display: inline-block; width: 50%; border: 1px solid gray;">
		<div>Please Insert Your Message Here</div>
		<div>
			<input class="message" type="text" name="message" value='abc'>
		</div>
	</div>
	<div style="display: inline-block; width: 50%; border: 1px solid gray;">
		<div>Please Insert Your Secret Message Here</div>
		<div>
			<input class="secret" type="text" name="secret" value='123'>
		</div>
	</div>
	<div style="text-align: center;"><button type="button">Generate</button></div>
	<div>Result</div>
	<div><input id="result"></div>

	<div>Decript Result</div>
	<input id='decript'>
</body>

</html